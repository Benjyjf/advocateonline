container_commands:
  01_install_solr:
    command: "
    wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-5.5.3.tar.gz &&
    tar xzf elasticsearch-5.5.3.tar.gz"
    leader_only: true
  02writable_dirs:
    command: "sudo chmod -R 775 elasticsearch-5.5.3/"
    
commands:
  create_post_dir:
    command: "mkdir /opt/elasticbeanstalk/hooks/appdeploy/post"
    ignoreErrors: true

files:
  "/opt/elasticbeanstalk/hooks/appdeploy/post/start_solr.sh":
    mode: "000755"
    owner: root
    group: root
    content: |
      #!/usr/bin/env bash
      sudo /opt/python/current/app/elasticsearch-6.5.3/bin/elasticsearch &